<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>IvInfo</title>
</head>
<body>
<div class="page type-interior pluginConfigurationPage configPage" data-require="emby-input,emby-button,emby-checkbox"
     data-role="page">
    <div data-role="content">
        <div class="content-primary">
            <form class="configForm">
                <fieldset>
                    <legend>Enabled scrapers</legend>
                    <label class="checkboxContainer">
                        <input id="javlibrary" is="emby-checkbox" type="checkbox"/>
                        <span>Javlibrary scraper</span>
                    </label>
                    <label class="checkboxContainer">
                        <input id="dmm" is="emby-checkbox" type="checkbox"/>
                        <span>DMM scraper</span>
                    </label>
                    <label class="checkboxContainer">
                        <input id="gekiyasu" is="emby-checkbox" type="checkbox"/>
                        <span>Gekiyasu scraper</span>
                    </label>
                </fieldset>
                <br/>
                <div>
                    <button class="raised button-submit block" is="emby-button" type="submit"><span>Save</span></button>
                </div>
            </form>
        </div>
    </div>
    <script type="text/javascript">
            var PluginConfig = {
                pluginId: "abe0c619-a145-4890-896b-cb1089ade4fe"
            };

            document.querySelector('.configPage')
                .addEventListener('pageshow', function () {
                    Dashboard.showLoadingMsg();
                    ApiClient.getPluginConfiguration(PluginConfig.pluginId).then(function (config) {
                        document.querySelector('#javlibrary').checked = config.JavlibraryScraperEnabled;
                        document.querySelector('#dmm').checked = config.DMMScraperEnabled;
                        document.querySelector('#gekiyasu').checked = config.GekiyasuScraperEnabled;
                        Dashboard.hideLoadingMsg();
                    });
                });

            
            document.querySelector('.configForm')
                .addEventListener('submit', function (e) {
                    Dashboard.showLoadingMsg();
    
                    ApiClient.getPluginConfiguration(PluginConfig.pluginId).then(function (config) {
                        config.JavlibraryScraperEnabled = document.querySelector('#javlibrary').checked;
                        config.DMMScraperEnabled = document.querySelector('#dmm').checked;
                        config.GekiyasuScraperEnabled = document.querySelector('#gekiyasu').checked;
                        ApiClient.updatePluginConfiguration(PluginConfig.pluginId, config).then(Dashboard.processPluginConfigurationUpdateResult);
                    });
                    
                    e.preventDefault();
                    return false;
                });        
    
    </script>
</div>
</body>
</html>